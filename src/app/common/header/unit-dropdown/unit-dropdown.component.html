<div fxLayout="row" fxLayoutAlign="start center">
  <div
    *ngIf="unit"
    class="bg-formatif-blue text-white rounded-full cursor-pointer pl-6 pr-6 min-h-12 h-12 flex items-center"
    style="font-size: 14px"
    matTooltip="{{ unit.name }}"
    [matMenuTriggerFor]="menu"
    #menuState="matMenuTrigger"
  >
    <span class="text-md">{{ unit?.code }}</span>
    <mat-icon>{{ menuState.menuOpen ? 'arrow_drop_up' : 'arrow_drop_down' }} </mat-icon>
  </div>

  <ng-container *ngIf="!unit">
    <button mat-button [matMenuTriggerFor]="menu" #menuState="matMenuTrigger">
      <span fxLayout="row" fxLayoutAlign="start center">
        <span>Select Unit</span>
        <mat-icon>{{ menuState.menuOpen ? 'arrow_drop_up' : 'arrow_drop_down' }} </mat-icon>
      </span>
    </button>
  </ng-container>
</div>

<mat-menu #menu="matMenu" class="unit-dropdown-menu">
  <button *ngIf="media.isActive('xs')" uiSref="home" fxLayout="row" fxLayoutAlign="start center" mat-menu-item>
    <mat-icon
      uiSref="home"
      style="margin-right: 20px"
      svgIcon="formatif-logo"
      class="formatif-icon"
      aria-label="Home Icon"
    ></mat-icon>
    <div class="unitName">Home</div>
    <span fxFlex></span>
  </button>
  <mat-divider *ngIf="media.isActive('xs')"></mat-divider>

  <div mat-subheader [hidden]="unitRoles?.length === 0">Units you teach</div>
  <ng-container *ngFor="let unitRole of unitRoles">
    <div
      *ngIf="!unitRole.unit.teachingPeriod || unitRole.unit.teachingPeriod?.active"
      uiSref="units/tasks/inbox"
      [uiParams]="{ unitId: unitRole.unit.id }"
      mat-menu-item
      class="w-full"
    >
      <div class="flex items-center w-full">
        <div class="flex-none unitName">{{ unitRole.unit.name }}</div>
        <div class="grow"></div>
        <div class="flex-none">
          <f-chip>
            {{ unitRole.unit.code }}
          </f-chip>
        </div>
      </div>
    </div>
  </ng-container>

  <mat-divider [hidden]="unitRoles?.length === 0 || projects?.length === 0"></mat-divider>
  <div mat-subheader [hidden]="projects?.length === 0">Units You Study</div>
  <ng-container *ngFor="let project of projects">
    <button
      *ngIf="!project.unit.teachingPeriod || project.unit.teachingPeriod.active"
      uiSref="projects/dashboard"
      [uiParams]="{ projectId: project.id, taskAbbr: '' }"
      fxLayout="row"
      fxLayoutAlign="start center"
      mat-menu-item
    >
      <div class="unitName">{{ project.unit.name }}</div>
      <span fxFlex style="flex-grow: 1"></span>
      <f-chip>
        {{ project.unit.code }}
      </f-chip>
    </button>
  </ng-container>
</mat-menu>
